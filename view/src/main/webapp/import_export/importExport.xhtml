<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:uib="http://engagepoint.com/uib"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                template="../template.xhtml">
    <ui:define name="mainContent">
        <uib:infoblock id="warn" visible="#{fileUploadController.show}" type="notification"
                       styleClass="ui-messages-warn">
            <p>#{fileUploadController.msgLbl}</p>
            <p:commandButton id="inf1" value="OK" styleClass="secondary small" icon="ui-icon-edit"
                             action="#{fileUploadController.hideMsg}"
                             update="warn"/>
        </uib:infoblock>
        <uib:infoblock id="ui-messages-error" visible="#{error.errorVisibility}" type="notification"
                       styleClass="ui-messages-error">
            <p>#{error.errorMessage}</p>
            <p:commandButton id="inf2" value="OK" styleClass="secondary small" icon="ui-icon-edit"
                             action="#{error.hideInfoBlock}"
                             update="ui-messages-error"/>
        </uib:infoblock>
        <h2>Export Import Type</h2>
        
        <uib:gridContainer>
            <uib:gridRow>

                <uib:gridColumn column="6">
                    <h:form id="selectOne">
                        <uib:gridContainer>
                            <uib:gridRow>
                                <uib:gridColumn column="6">
                                    <p:selectOneMenu value="#{fileDownloadController.type}">
                                        <p:ajax update="save"/>
                                        <f:selectItem itemLabel="Select One" itemValue=""/>
                                        <f:selectItems value="#{fileDownloadController.types}" var="type"
                                                       itemLabel="Save to #{type}" itemValue="#{type}"/>
                                    </p:selectOneMenu>
                                </uib:gridColumn>
                                <uib:gridColumn column="2">
                                    <p:commandButton id="save" value="Export" ajax="false"
                                                     actionListener="#{fileDownloadController.setDownloadedFile}"
                                                     disabled="#{treeBean.currentDTO == null or fileDownloadController.type == null}">
                                        <p:fileDownload value="#{fileDownloadController.file}"/>
                                    </p:commandButton>
                                </uib:gridColumn>
                            </uib:gridRow>
                        </uib:gridContainer>
                    </h:form>

                </uib:gridColumn>
                <uib:gridColumn column="3">
                    <h:form id="form">

                        <p:fileUpload
                                id = "import"
                                fileUploadListener="#{fileUploadController.handleFileUpload}"
                                mode="advanced" dragDropSupport="false"
                                label="Import"
                                multiple="true"
                                sizeLimit="100000"
                                allowTypes="/(\.|\/)(txt|xml|json)$/"
                                auto="true"
                                update=":warn, :ui-messages-error"/>
                    </h:form>
                </uib:gridColumn>

                <uib:gridColumn column="3">
                    <p:commandButton id="push" value="Push" action="#{fileUploadController.processFiles}" update=":warn" />
                </uib:gridColumn>

            </uib:gridRow>

            <uib:gridRow fluid="true">
                <uib:gridColumn column="12">
                    <h:form>
                        <p:tree id="tree"
                                value="#{treeBean.root}"
                                var="node"
                                dynamic="true"
                                selectionMode="single"
                                selection="#{treeBean.selected}">
                            <p:ajax event="select" listener="#{treeBean.onNodeSelect}" update=":selectOne:save"/>

                            <p:treeNode id="treeNode">
                                <h:outputText value="#{node}" id="lblNode"/>
                            </p:treeNode>
                        </p:tree>
                    </h:form>
                </uib:gridColumn>
            </uib:gridRow>
        </uib:gridContainer>



    </ui:define>
</ui:composition>