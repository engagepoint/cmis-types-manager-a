<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:uib="http://engagepoint.com/uib">

            <p:commandButton title="Add metadata" id="addMetadata" value="Add metadata"
                                 styleClass="secondary" update=":fullPropertyForm"
                                 action="#{createBean.clearNewPropertyRow}" oncomplete="addMetadataDialog.show()"/>

                <p:commandButton title="Create type" id="addType" value="Done"
                                 action="/show/index?faces-redirect=true"  actionListener="#{treeBean.createType(createBean.newTypeDTO)}"/>

                <p:selectCheckboxMenu value="#{tableBean.selectedColumns}"
                                      id="select"
                                      label="Select Columns for property table(maximum 4)"
                                      panelStyle="width:200px" >
                    <p:message for="select" id="msg"/>
                    <f:validator validatorId="com.engagepoint.teama.cmismanager.view.util.SelectColumnValidator"/>
                    <p:ajax update="allProperties, msg, allNewProperties"/>
                    <f:selectItems value="#{tableBean.columnsHeader}"/>
                </p:selectCheckboxMenu>

                <uib:dataTable id="allProperties" var="property" rows="5" paginator="true"
                               paginatorPosition="bottom"
                               paginatorTemplate="{PreviousPageLink} {PageLinks} {NextPageLink}"
                               value="#{createBean.currentDTO.propertyList}"
                               selection="#{createBean.propertyRowList}">
                    <f:attribute name="propRow" value="#{property}"/>

                    <p:columns value="#{tableBean.selectedColumns}" sortBy="column" var="column"
                               columnIndexVar="colIndex" width="230">
                        <f:facet name="header">
                            #{column}
                        </f:facet>
                        #{property[column]}
                    </p:columns>

                    <p:column headerText="Full Info">
                        <p:commandLink title="Full Info" id="fullInfo"
                                       actionListener="#{showBean.setNewPropertyRowShow(property)}"
                                       update=":fullPropertyForm"
                                       oncomplete="jQuery('#fullPropertyModal').modal('show');return false;">
                            <uib:icon id="one" value='page-details' alt='page-details' title='Full info'/>
                        </p:commandLink>
                    </p:column>
                </uib:dataTable>

         <uib:dataTable id="allNewProperties" var="property" rows="3" paginator="true"
                               paginatorPosition="bottom"
                               paginatorTemplate="{PreviousPageLink} {PageLinks} {NextPageLink}"
                               value="#{createBean.newTypeDTO.propertyList}" selection="#{createBean.propertyRowList}">

                    <f:attribute name="propRow" value="#{property}"/>

                    <p:columns value="#{tableBean.selectedColumns}" sortBy="column" var="column"
                               columnIndexVar="colIndex" width="230">
                        <f:facet name="header">
                            #{column}
                        </f:facet>
                        #{property[column]}
                    </p:columns>
                    <p:column headerText="Full Info" width="30">

                        <p:commandLink title="Full Info" id="fullInfo"
                                       actionListener="#{createBean.setNewPropertyRowCreate(property)}"
                                       update=":fullPropertyForm"
                                       oncomplete="jQuery('#fullPropertyModal').modal('show');return false;">
                            <uib:icon id="one" value='page-details' alt='page-details' title='Full info'/>
                        </p:commandLink>

                    </p:column>
                </uib:dataTable>
</ui:composition>