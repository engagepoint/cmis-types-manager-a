<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                template="../template.xhtml"
                xmlns:uib="http://engagepoint.com/uib">
<h:head>
    <title>Index page</title>
</h:head>

<ui:define name="mainContent">
<p:commandButton id="createError" update="uib-norification-warn" action="#{treeBean.creat()}"/>
<uib:infoblock id="uib-norification-warn" visible="#{treeBean.errorVisibility}" type="notification"
               styleClass="ui-messages-warn">
    <p>#{treeBean.errorMessage}</p>
</uib:infoblock>

<h2>Create new type</h2>
<uib:gridContainer>

<uib:gridRow>
<uib:gridColumn column="12">


<p:tabView effect="#{tabBean.effect}" id="tabView" effectDuration="normal">

<p:tab title="Step I">
    <h3>Chose tree node:</h3>
    <h:panelGrid columns="2" cellpadding="10">

        <h:form id="treeForm" styleClass="mar30">

            <p:tree value="#{treeBean.root}"
                    var="node"
                    id="tree"
                    dynamic="true"
                    selectionMode="single"
                    selection="#{treeBean.selected}">
                <p:ajax event="select" listener="#{treeBean.onNodeSelect}"
                        update=":fullPropertyForm, :tabView:allPropertiesForm, :tabView:Add"/>

                <p:treeNode id="treeNode">
                    <h:outputText value="#{node}" id="lblNode"/>
                </p:treeNode>
            </p:tree>
        </h:form>
    </h:panelGrid>
</p:tab>

<p:tab id="step2" title="Step II">
<h3>Input attributes</h3>
<h:panelGrid id="grid" columns="2" cellpadding="10">
<h:form id="Add" prependId="false" styleClass="mar30">

<uib:gridContainer>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Name"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="displayName" placeholder="Input value:"
                   value="#{treeBean.newDTO.displayName}" required="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="ID"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="id" placeholder="Input value:"
                   value="#{treeBean.newDTO.id}" required="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Description"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="description" placeholder="Input value:"
                   value="#{treeBean.newDTO.description}" required="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Query name"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="queryName" placeholder="Input value:"
                   value="#{treeBean.newDTO.queryName}" required="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Local name"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="localName" placeholder="Input value:"
                   value="#{treeBean.newDTO.localName}" required="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Parent"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="parentId" value="#{treeBean.currentDTO.id}" disabled="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Base type"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="baseTypeId" value="#{treeBean.currentDTO.baseTypeId}" disabled="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Local namespace"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <uib:input id="localNamespace" placeholder="Input value:"
                   value="#{treeBean.newDTO.localNamespace}" required="true"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Creatable"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="creatable" value="#{treeBean.newDTO.creatable}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Fileable"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="fileable" value="#{treeBean.newDTO.fileable}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Queryable"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="queryable" value="#{treeBean.newDTO.queryable}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Included in supertype query"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="includedInSupertypeQuery" value="#{treeBean.newDTO.includedInSupertypeQuery}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Full text indexed"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="fulltextIndexed" value="#{treeBean.newDTO.fulltextIndexed}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="ACL controllable"/>
    </uib:gridColumn>
    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="controllableAcl" value="#{treeBean.newDTO.controllableAcl}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="4" styleClass="tar">
        <p:outputLabel value="Policy controllable"/>
    </uib:gridColumn>

    <uib:gridColumn column="8">
        <p:selectBooleanCheckbox id="controllablePolicy" value="#{treeBean.newDTO.controllablePolicy}"/>
    </uib:gridColumn>

</uib:gridRow>

<uib:gridRow fluid="true">

    <uib:gridColumn column="12">

        <uib:gridContainer>

            <uib:gridRow>
                <uib:gridColumn column="4" styleClass="tar">
                    <p:outputLabel value="Mutability"/>
                </uib:gridColumn>
                <uib:gridColumn column="8">
                </uib:gridColumn>
            </uib:gridRow>

            <uib:gridRow fluid="true">
                <uib:gridColumn column="4" styleClass="tar">
                    <p:outputLabel value="can create"/>
                </uib:gridColumn>
                <uib:gridColumn column="8">
                    <p:selectBooleanCheckbox id="mutabilityCanCreate" value="#{treeBean.newDTO.mutabilityCanCreate}"/>
                </uib:gridColumn>
            </uib:gridRow>

            <uib:gridRow fluid="true">
                <uib:gridColumn column="4" styleClass="tar">
                    <p:outputLabel value="can delete"/>
                </uib:gridColumn>
                <uib:gridColumn column="8">
                    <p:selectBooleanCheckbox id="mutabilityCanDelete" value="#{treeBean.newDTO.mutabilityCanDelete}"/>
                </uib:gridColumn>
            </uib:gridRow>

            <uib:gridRow fluid="true">
                <uib:gridColumn column="4" styleClass="tar">
                    <p:outputLabel value="can update"/>
                </uib:gridColumn>
                <uib:gridColumn column="8">
                    <p:selectBooleanCheckbox id="mutabilityCanUpdate" value="#{treeBean.newDTO.mutabilityCanUpdate}"/>
                </uib:gridColumn>
            </uib:gridRow>

        </uib:gridContainer>

    </uib:gridColumn>

</uib:gridRow>


</uib:gridContainer>


<f:facet name="footer">
    <!-- cleanUpdateForm does not exsist -->

    <p:commandButton title="Cancel" id="cancelButton" action="#{treeBean.cleanUpdateForm}" mode="client" value="Cancel"
                     styleClass="secondary"
                     oncomplete="jQuery('#AddModal').modal('hide');return false;"/>
    <p:commandButton title="Add" id="AddButton" action="#{treeBean.addType}" mode="client" value="Add"
                     oncomplete="jQuery('#AddModal').modal('hide');return false;"/>
</f:facet>

</h:form>

</h:panelGrid>
</p:tab>

<p:tab title="Step III">
    <h3> Chose secondary type </h3>
    <uib:gridContainer>
        <uib:gridRow fluid="true">
            <uib:gridColumn column="4">
                <h:form id="form">

                    <p:tree value="#{secType.root}" var="node"
                            selectionMode="multiple"
                            selection="#{secType.selectedNodes}"
                            id="treeMultiple" dynamic="true">
                        <p:ajax event="select" update=":tabView:table"/>
                        <p:treeNode>
                            <h:outputText value="#{node}"/>
                        </p:treeNode>
                    </p:tree>
                </h:form>
            </uib:gridColumn>

            <uib:gridColumn column="8">
                <uib:dataTable id="table" var="secondaryTypes"
                               rows="40"
                               value="#{secType.secondaryTypes}">
                    <p:column headerText="Selected secondary types">
                        <h:outputText id="prop_id" value="#{secondaryTypes.displayName}" var="id"/>

                    </p:column>

                </uib:dataTable>
            </uib:gridColumn>
        </uib:gridRow>
    </uib:gridContainer>
</p:tab>

<p:tab title="Step IV">
    <h3>View parent metadata and add new one</h3>
    <h:panelGrid columns="2" cellpadding="10">

        <h:form id="allPropertiesForm" prependId="false" rendered="true">
            <uib:dataTable id="allProperties" var="property"
                           rows="30"
                           value="#{treeBean.currentDTO.propertyList}" selection="#{treeBean.propertyRows}">
                <f:attribute name="propRow" value="#{property}"/>
                <p:column headerText="ID">
                    <h:outputText id="prop_id" value="#{property.id}" var="id"/>
                </p:column>
                <p:column headerText="Display Name">
                    <h:outputText value="#{property.displayName}"/>
                </p:column>
                <p:column headerText="Description">
                    <h:outputText value="#{property.description}"/>
                </p:column>
                <p:column headerText="Full Info">
                    <p:commandButton title="Full Info" id="fullInfo" value="Info"
                                     actionListener="#{treeBean.passProperty(property)}"
                                     update=":fullPropertyForm"
                                     oncomplete="jQuery('#fullPropertyModal').modal('show');return false;"/>
                </p:column>
            </uib:dataTable>
            <p:commandButton title="Add metadata" id="addMetadata" value="Add metadata"
                             update=":fullPropertyForm"
                             oncomplete="jQuery('#addMetadataModal').modal('show');return false;"/>
        </h:form>


    </h:panelGrid>
</p:tab>


</p:tabView>


</uib:gridColumn>
</uib:gridRow>

</uib:gridContainer>


<h:form id="fullPropertyForm" prependId="false">
    <uib:modal id="fullPropertyModal" header="Full Property Info">
        <p:panelGrid columns="2" id="fullPropertyGrid">

            <h:outputText value="ID: "/>
            <h:outputText value="#{treeBean.propertyRow1.id}"/>

            <h:outputText value="Local Name: "/>
            <h:outputText value="#{treeBean.propertyRow1.localName}"/>

            <h:outputText value="Local Namespace: "/>
            <h:outputText value="#{treeBean.propertyRow1.localNamespace}"/>

            <h:outputText value="Display Name: "/>
            <h:outputText value="#{treeBean.propertyRow1.displayName}"/>

            <h:outputText value="Query Name: "/>
            <h:outputText value="#{treeBean.propertyRow1.queryName}"/>

            <h:outputText value="Description: "/>
            <h:outputText value="#{treeBean.propertyRow1.description}"/>

            <h:outputText value="Inherited: "/>
            <h:outputText value="#{treeBean.propertyRow1.inherited}"/>

            <h:outputText value="Required: "/>
            <h:outputText value="#{treeBean.propertyRow1.required}"/>

            <h:outputText value="Queryable: "/>
            <h:outputText value="#{treeBean.propertyRow1.queryable}"/>

            <h:outputText value="Orderable: "/>
            <h:outputText value="#{treeBean.propertyRow1.orderable}"/>

            <h:outputText value="Open Choice: "/>
            <h:outputText value="#{treeBean.propertyRow1.openChoice}"/>

            <h:outputText value="Property Type: "/>
            <h:outputText value="#{treeBean.propertyRow1.propertyType}"/>

            <h:outputText value="Cardinality: "/>
            <h:outputText value="#{treeBean.propertyRow1.cardinality}"/>

            <h:outputText value="Updatability: "/>
            <h:outputText value="#{treeBean.propertyRow1.updatability}"/>

            <h:outputText value="Choise List: "/>
            <h:outputText value="#{treeBean.propertyRow1.choiseList}"/>

            <h:outputText value="Default Value: "/>
            <h:outputText value="#{treeBean.propertyRow1.defaultValue}"/>

            <h:outputText value="Extensions: "/>
            <h:outputText value="#{treeBean.propertyRow1.extensions}"/>
        </p:panelGrid>
        <f:facet name="footer">

            <p:commandButton title="Cancel" mode="client" value="Cancel"
                             styleClass="secondary"
                             oncomplete="jQuery('#fullPropertyModal').modal('hide');
return false;"/>
        </f:facet>
    </uib:modal>
</h:form>


<h:form id="addMetadata" prependId="false">
    <uib:modal id="addMetadataModal" header="Add metadata">
        <p:panelGrid columns="2" id="metadataGrid">

            <h:outputText value="ID: "/>
            <p:inputText value="#{treeBean.newProperty.id}"/>

            <h:outputText value="Local Name: "/>
            <p:inputText value="#{treeBean.newProperty.localName}"/>

            <h:outputText value="Local Namespace: "/>
            <p:inputText value="#{treeBean.newProperty.localNamespace}"/>

            <h:outputText value="Display Name: "/>
            <p:inputText value="#{treeBean.newProperty.displayName}"/>

            <h:outputText value="Query Name: "/>
            <p:inputText value="#{treeBean.newProperty.queryName}"/>

            <h:outputText value="Description: "/>
            <p:inputText value="#{treeBean.newProperty.description}"/>

            <h:outputText value="Inherited: "/>
            <p:inputText value="#{treeBean.newProperty.inherited}"/>

            <h:outputText value="Required: "/>
            <p:inputText value="#{treeBean.newProperty.required}"/>

            <h:outputText value="Queryable: "/>
            <p:inputText value="#{treeBean.newProperty.queryable}"/>

            <h:outputText value="Orderable: "/>
            <p:inputText value="#{treeBean.newProperty.orderable}"/>

            <h:outputText value="Open Choice: "/>
            <p:inputText value="#{treeBean.newProperty.openChoice}"/>

            <h:outputText value="Property Type: "/>
            <p:inputText value="#{treeBean.newProperty.propertyType}"/>

            <h:outputText value="Cardinality: "/>
            <p:inputText value="#{treeBean.newProperty.cardinality}"/>

            <h:outputText value="Updatability: "/>
            <p:inputText value="#{treeBean.newProperty.updatability}"/>

            <h:outputText value="Choise List: "/>
            <p:inputText value="#{treeBean.newProperty.choiseList}"/>

            <h:outputText value="Default Value: "/>
            <p:inputText value="#{treeBean.newProperty.defaultValue}"/>

            <h:outputText value="Extensions: "/>
            <p:inputText value="#{treeBean.newProperty.extensions}"/>
        </p:panelGrid>
        <f:facet name="footer">

            <p:commandButton title="Cancel" mode="client" value="Cancel"
                             styleClass="secondary"
                             oncomplete="jQuery('#addMetadataModal').modal('hide');
return false;"
                    />
            <p:commandButton title="Add" mode="client" value="Add metadata"
                             styleClass="secondary"
                             oncomplete="jQuery('index2').modal('hide');
return false;" update=":tabView:allPropertiesForm"
                             action="#{treeBean.addMetadata}"/>
        </f:facet>
    </uib:modal>

    <uib:infoblock id="errorMessageDelete" type="notification"
                   styleClass="ui-messages-warn">
        <p>There is no node selected. Select any type to delete it. </p>
    </uib:infoblock>


</h:form>



</ui:define>
</ui:composition>